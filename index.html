<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pendule Invers√© sur Chariot - Analyse Compl√®te</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin-bottom: 30px;
            text-align: center;
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.2em;
        }

        .section {
            background: white;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            color: #764ba2;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        h3 {
            color: #667eea;
            font-size: 1.5em;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .parameters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .param-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s;
        }

        .param-card:hover {
            transform: translateY(-5px);
        }

        .param-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .param-value {
            font-size: 1.8em;
            font-weight: bold;
        }

        .canvas-container {
            position: relative;
            width: 100%;
            height: 400px;
            margin: 30px 0;
            background: #f8f9fa;
            border-radius: 10px;
            overflow: hidden;
        }

        canvas {
            display: block;
        }

        .matrix-display {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .matrix {
            display: inline-block;
            padding: 15px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        table {
            border-collapse: collapse;
            margin: 20px auto;
        }

        td {
            padding: 10px 20px;
            text-align: center;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
        }

        .bracket-left::before {
            content: '[';
            font-size: 4em;
            position: absolute;
            left: -15px;
            top: 50%;
            transform: translateY(-50%);
        }

        .bracket-right::after {
            content: ']';
            font-size: 4em;
            position: absolute;
            right: -15px;
            top: 50%;
            transform: translateY(-50%);
        }

        .result-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-size: 1.2em;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .warning {
            background: linear-gradient(135deg, #ee0979 0%, #ff6a00 100%);
        }

        .info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1em;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        .slider-container {
            margin: 20px 0;
        }

        .slider-container label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #667eea;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .value-display {
            text-align: center;
            font-size: 1.2em;
            color: #764ba2;
            font-weight: bold;
            margin-top: 5px;
        }

        .equation {
            background: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #667eea;
            margin: 15px 0;
            border-radius: 5px;
            overflow-x: auto;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .parameters {
                grid-template-columns: 1fr;
            }
            
            .canvas-container {
                height: 300px;
            }
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            background: #f8f9fa;
            border: 2px solid #667eea;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ Pendule Invers√© sur Chariot</h1>
            <p class="subtitle">Analyse Compl√®te du Syst√®me Dynamique - Exercice 4</p>
        </header>

        <!-- Section Param√®tres -->
        <div class="section">
            <h2>üìä Param√®tres Physiques du Syst√®me</h2>
            <div class="parameters">
                <div class="param-card">
                    <div class="param-label">Masse du Chariot (M)</div>
                    <div class="param-value">1.0 kg</div>
                </div>
                <div class="param-card">
                    <div class="param-label">Masse du Pendule (m)</div>
                    <div class="param-value">0.2 kg</div>
                </div>
                <div class="param-card">
                    <div class="param-label">Longueur du Pendule (l)</div>
                    <div class="param-value">0.5 m</div>
                </div>
                <div class="param-card">
                    <div class="param-label">Gravit√© (g)</div>
                    <div class="param-value">9.81 m/s¬≤</div>
                </div>
            </div>
        </div>

        <!-- Section Animation -->
        <div class="section">
            <h2>üé¨ Animation Interactive du Syst√®me</h2>
            <div class="canvas-container">
                <canvas id="pendulumCanvas"></canvas>
            </div>
            <div class="controls">
                <button onclick="startSimulation()">‚ñ∂Ô∏è D√©marrer</button>
                <button onclick="stopSimulation()">‚è∏Ô∏è Pause</button>
                <button onclick="resetSimulation()">üîÑ R√©initialiser</button>
            </div>
            <div class="slider-container">
                <label>Angle Initial Œ∏‚ÇÄ (degr√©s)</label>
                <input type="range" id="angleSlider" min="-45" max="45" value="10" step="1" oninput="updateAngle(this.value)">
                <div class="value-display" id="angleValue">10¬∞</div>
            </div>
            <div class="slider-container">
                <label>Force Appliqu√©e F (N)</label>
                <input type="range" id="forceSlider" min="-20" max="20" value="0" step="0.5" oninput="updateForce(this.value)">
                <div class="value-display" id="forceValue">0 N</div>
            </div>
        </div>

        <!-- Section 1: Repr√©sentation d'√©tat -->
        <div class="section">
            <h2>1Ô∏è‚É£ Repr√©sentation d'√âtat du Syst√®me</h2>
            
            <h3>Variables d'√âtat</h3>
            <div class="equation">
                $$\mathbf{X} = \begin{bmatrix} \theta \\ \dot{\theta} \\ x \\ \dot{x} \end{bmatrix}$$
            </div>

            <h3>√âquations du Syst√®me</h3>
            <div class="equation">
                <strong>Pendule:</strong> $$F(t) = (M+m)g \cdot \theta(t) - l \cdot \ddot{\theta}(t)$$
            </div>
            <div class="equation">
                <strong>Chariot:</strong> $$F(t) = M \cdot \ddot{x}(t) + m \cdot g \cdot \theta(t)$$
            </div>

            <h3>Forme Matricielle: ·∫ä = AX + Bu</h3>
            
            <div class="matrix-display">
                <strong>Matrice A:</strong>
                <div class="matrix">
                    <table style="position: relative;">
                        <tr>
                            <td>0</td>
                            <td>1</td>
                            <td>0</td>
                            <td>0</td>
                        </tr>
                        <tr>
                            <td>23.544</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                        </tr>
                        <tr>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>-1.962</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="matrix-display">
                <strong>Matrice B:</strong>
                <div class="matrix">
                    <table style="position: relative;">
                        <tr><td>0</td></tr>
                        <tr><td>-2</td></tr>
                        <tr><td>0</td></tr>
                        <tr><td>1</td></tr>
                    </table>
                </div>
            </div>

            <div class="matrix-display">
                <strong>Matrice C (Sortie):</strong>
                <div class="matrix">
                    <table style="position: relative;">
                        <tr>
                            <td>1</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                        </tr>
                        <tr>
                            <td>0</td>
                            <td>0</td>
                            <td>1</td>
                            <td>0</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="result-box info">
                <strong>Type de Syst√®me:</strong> MIMO (1 entr√©e, 2 sorties) - Lin√©aire Continu - Ordre 4
            </div>
        </div>

        <!-- Section 2: Sch√©ma Bloc -->
        <div class="section">
            <h2>2Ô∏è‚É£ Sch√©ma Bloc du Syst√®me</h2>
            <div class="canvas-container" style="height: 300px; background: white;">
                <canvas id="blockDiagram"></canvas>
            </div>
        </div>

        <!-- Section 3: Fonction de Transfert -->
        <div class="section">
            <h2>3Ô∏è‚É£ Matrice de Transfert et √âquation Caract√©ristique</h2>
            
            <h3>Fonction de Transfert</h3>
            <div class="equation">
                $$H(s) = C(sI - A)^{-1}B + D$$
            </div>

            <h3>√âquation Caract√©ristique</h3>
            <div class="equation">
                $$\det(sI - A) = s^4 - 23.544s^2 = 0$$
                $$s^2(s^2 - 23.544) = 0$$
            </div>

            <h3>P√¥les du Syst√®me</h3>
            <div class="result-box info">
                <strong>s‚ÇÅ, s‚ÇÇ = 0</strong> (multiplicit√© 2)<br>
                <strong>s‚ÇÉ = +4.852</strong> rad/s<br>
                <strong>s‚ÇÑ = -4.852</strong> rad/s
            </div>

            <div class="chart-container">
                <canvas id="polesChart"></canvas>
            </div>
        </div>

        <!-- Section 4: Stabilit√© -->
        <div class="section">
            <h2>4Ô∏è‚É£ Analyse de Stabilit√©</h2>
            
            <h3>Valeurs Propres de la Matrice A</h3>
            <div class="equation">
                <ul style="list-style: none; padding: 0;">
                    <li>‚ú¶ Œª‚ÇÅ = 0 (double)</li>
                    <li>‚ú¶ Œª‚ÇÇ ‚âà +4.852 (partie r√©elle positive)</li>
                    <li>‚ú¶ Œª‚ÇÉ ‚âà -4.852 (partie r√©elle n√©gative)</li>
                </ul>
            </div>

            <div class="result-box warning">
                <strong>‚ö†Ô∏è SYST√àME INSTABLE</strong><br>
                Le syst√®me poss√®de une valeur propre avec partie r√©elle positive (+4.852)<br>
                Le pendule invers√© n√©cessite un contr√¥le actif pour √™tre stabilis√©
            </div>

            <div class="chart-container">
                <canvas id="stabilityChart"></canvas>
            </div>
        </div>

        <!-- Section 5: Commandabilit√© et Observabilit√© -->
        <div class="section">
            <h2>5Ô∏è‚É£ Commandabilit√© et Observabilit√©</h2>
            
            <div class="tabs">
                <div class="tab active" onclick="switchTab('commandability')">Commandabilit√©</div>
                <div class="tab" onclick="switchTab('observability')">Observabilit√©</div>
            </div>

            <div id="commandability" class="tab-content active">
                <h3>Matrice de Commandabilit√©</h3>
                <div class="equation">
                    $$Q_c = [B \quad AB \quad A^2B \quad A^3B]$$
                </div>
                
                <div class="matrix-display">
                    <div class="matrix">
                        <table style="position: relative;">
                            <tr>
                                <td>0</td>
                                <td>-2</td>
                                <td>-2</td>
                                <td>0</td>
                            </tr>
                            <tr>
                                <td>-2</td>
                                <td>0</td>
                                <td>0</td>
                                <td>-47.088</td>
                            </tr>
                            <tr>
                                <td>0</td>
                                <td>1</td>
                                <td>0</td>
                                <td>-3.924</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>0</td>
                                <td>-3.924</td>
                                <td>0</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="result-box success">
                    <strong>‚úÖ SYST√àME COMMANDABLE</strong><br>
                    rang(Qc) = 4 = n
                </div>
            </div>

            <div id="observability" class="tab-content">
                <h3>Matrice d'Observabilit√©</h3>
                <div class="equation">
                    $$Q_o = \begin{bmatrix} C \\ CA \\ CA^2 \\ CA^3 \end{bmatrix}$$
                </div>

                <div class="result-box success">
                    <strong>‚úÖ SYST√àME OBSERVABLE</strong><br>
                    rang(Qo) = 4 = n
                </div>
            </div>
        </div>

        <!-- Section 6: D√©composition -->
        <div class="section">
            <h2>6Ô∏è‚É£ D√©composition en Sous-Syst√®mes</h2>
            
            <div class="result-box info">
                Le syst√®me est d√©j√† <strong>enti√®rement commandable</strong>, donc la d√©composition n'est pas n√©cessaire.
            </div>

            <h3>D√©composition Physique (Informative)</h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h4 style="color: #667eea;">Sous-syst√®me 1: Pendule</h4>
                    <div class="equation">
                        $$\dot{X}_1 = \begin{bmatrix} 0 & 1 \\ 23.544 & 0 \end{bmatrix} X_1 + \begin{bmatrix} 0 \\ -2 \end{bmatrix} u$$
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h4 style="color: #667eea;">Sous-syst√®me 2: Chariot</h4>
                    <div class="equation">
                        $$\dot{X}_2 = \begin{bmatrix} 0 & 1 \\ -1.962 & 0 \end{bmatrix} X_2 + \begin{bmatrix} 0 \\ 1 \end{bmatrix} u$$
                    </div>
                </div>
            </div>
        </div>

        <!-- Section R√©sum√© -->
        <div class="section">
            <h2>üìã R√©sum√© des R√©sultats</h2>
            <table style="width: 100%; border: 2px solid #667eea;">
                <thead>
                    <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                        <th style="padding: 15px; text-align: left;">Crit√®re</th>
                        <th style="padding: 15px; text-align: left;">R√©sultat</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="background: #f8f9fa;">
                        <td style="padding: 15px;"><strong>Type de syst√®me</strong></td>
                        <td style="padding: 15px;">MIMO, Lin√©aire, Ordre 4</td>
                    </tr>
                    <tr>
                        <td style="padding: 15px;"><strong>Stabilit√©</strong></td>
                        <td style="padding: 15px; color: #ee0979;"><strong>‚ùå INSTABLE</strong> (p√¥le √† +4.852)</td>
                    </tr>
                    <tr style="background: #f8f9fa;">
                        <td style="padding: 15px;"><strong>Commandabilit√©</strong></td>
                        <td style="padding: 15px; color: #38ef7d;"><strong>‚úÖ OUI</strong></td>
                    </tr>
                    <tr>
                        <td style="padding: 15px;"><strong>Observabilit√©</strong></td>
                        <td style="padding: 15px; color: #38ef7d;"><strong>‚úÖ OUI</strong></td>
                    </tr>
                    <tr style="background: #f8f9fa;">
                        <td style="padding: 15px;"><strong>D√©composition n√©cessaire</strong></td>
                        <td style="padding: 15px;">Non (syst√®me d√©j√† commandable)</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Variables globales
        let animationId;
        let time = 0;
        let theta = 10 * Math.PI / 180; // Angle initial en radians
        let force = 0;
        let isRunning = false;

        // Param√®tres du syst√®me
        const M = 1.0;  // kg
        const m = 0.2;  // kg
        const l = 0.5;  // m
        const g = 9.81; // m/s¬≤

        // Animation du pendule
        function drawPendulum() {
            const canvas = document.getElementById('pendulumCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const scale = 150;

            // Effacer le canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Dessiner le sol
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(0, centerY + 80);
            ctx.lineTo(canvas.width, centerY + 80);
            ctx.stroke();

            // Hachures du sol
            for (let i = 0; i < canvas.width; i += 20) {
                ctx.beginPath();
                ctx.moveTo(i, centerY + 80);
                ctx.lineTo(i + 10, centerY + 90);
                ctx.stroke();
            }

            // Position du chariot
            const cartX = centerX;
            const cartY = centerY + 50;
            const cartWidth = 100;
            const cartHeight = 40;

            // Dessiner le chariot
            ctx.fillStyle = '#667eea';
            ctx.fillRect(cartX - cartWidth/2, cartY - cartHeight/2, cartWidth, cartHeight);
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.strokeRect(cartX - cartWidth/2, cartY - cartHeight/2, cartWidth, cartHeight);

            // Roues du chariot
            const wheelRadius = 10;
            ctx.fillStyle = '#333';
            ctx.beginPath();
            ctx.arc(cartX - 30, cartY + cartHeight/2, wheelRadius, 0, 2 * Math.PI);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(cartX + 30, cartY + cartHeight/2, wheelRadius, 0, 2 * Math.PI);
            ctx.fill();

            // Point d'attache du pendule
            const pivotX = cartX;
            const pivotY = cartY - cartHeight/2;

            // Position de la masse du pendule
            const pendulumLength = l * scale;
            const bobX = pivotX + pendulumLength * Math.sin(theta);
            const bobY = pivotY + pendulumLength * Math.cos(theta);

            // Dessiner la tige du pendule
            ctx.strokeStyle = '#764ba2';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(pivotX, pivotY);
            ctx.lineTo(bobX, bobY);
            ctx.stroke();

            // Dessiner la masse du pendule
            const bobRadius = 15;
            ctx.fillStyle = '#f5576c';
            ctx.beginPath();
            ctx.arc(bobX, bobY, bobRadius, 0, 2 * Math.PI);
            ctx.fill();
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Dessiner le pivot
            ctx.fillStyle = '#333';
            ctx.beginPath();
            ctx.arc(pivotX, pivotY, 6, 0, 2 * Math.PI);
            ctx.fill();

            // Afficher la force appliqu√©e
            if (Math.abs(force) > 0.1) {
                const arrowLength = Math.abs(force) * 5;
                const arrowX = force > 0 ? cartX + cartWidth/2 : cartX - cartWidth/2;
                
                ctx.strokeStyle = '#ff6a00';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(arrowX, cartY);
                ctx.lineTo(arrowX + (force > 0 ? arrowLength : -arrowLength), cartY);
                ctx.stroke();

                // Pointe de la fl√®che
                ctx.fillStyle = '#ff6a00';
                ctx.beginPath();
                if (force > 0) {
                    ctx.moveTo(arrowX + arrowLength, cartY);
                    ctx.lineTo(arrowX + arrowLength - 10, cartY - 5);
                    ctx.lineTo(arrowX + arrowLength - 10, cartY + 5);
                } else {
                    ctx.moveTo(arrowX - arrowLength, cartY);
                    ctx.lineTo(arrowX - arrowLength + 10, cartY - 5);
                    ctx.lineTo(arrowX - arrowLength + 10, cartY + 5);
                }
                ctx.fill();
            }

            // Afficher l'angle
            ctx.fillStyle = '#333';
            ctx.font = '16px Arial';
            ctx.fillText(`Œ∏ = ${(theta * 180 / Math.PI).toFixed(1)}¬∞`, 20, 30);
            ctx.fillText(`t = ${time.toFixed(2)}s`, 20, 50);
        }

        // Simulation de la dynamique
        function updateSimulation(dt) {
